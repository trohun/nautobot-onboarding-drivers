sync_devices:
  # Hostname from "show system"
  hostname:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].name"

  # Serial number from "show system"
  serial:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].serial"

  # Device type - simplest is to hard-code or map from hostname/software_version
  # Here we just use the hostname as a placeholder; you can change post_processor
  device_type:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].name"
        # Example: hard-code a specific DeviceType name if you want
        # post_processor: "{{ 'Aruba 2530-8' }}"
        # Or leave as-is and map later in Nautobot

  # Manufacturer - hard-code to HPE/Aruba
  manufacturer:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].name"
        post_processor: "{{ 'HPE' }}"

  # Platform - use software version string
  platform:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].software_version"

  # Management interface - VLAN name for the management IP
  mgmt_interface:
    commands:
      - command: "show ip"
        parser: "textfsm"
        # Pick the row where ip_address == 10.228.0.18 and return its vlan_name
        jpath: "[?ip_address=='10.228.0.18'].vlan_name | [0]"

  # Management mask length - MUST be integer per schema
  # We know 10.228.0.18 has 255.255.255.0 => /24, so we hard-code 24 as a number
  mask_length:
    commands:
      - command: "show ip"
        parser: "textfsm"
        # Convert string '24' to numeric 24 using JMESPath to_number()
        jpath: "to_number('24')"
