sync_devices:
  hostname:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].name"
  serial:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].serial"
  device_type:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].software_version"
  manufacturer:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].software_version"
        post_processor: "{{ 'Aruba' }}"
  platform:
    commands:
      - command: "show system"
        parser: "textfsm"
        jpath: "[0].software_version"
  mgmt_interface:
    commands:
      - command: "show ip"
        parser: "textfsm"
        jpath: "raw"
        post_processor: "{% set filtered = obj | map(attribute='ip_address') | map('trim') | select('equalto', '10.228.0.18') | list %}{% if filtered | length > 0 %}{{ filtered | first.vlan_name }}{% else %}{{ 'it-management' }}{% endif %}"
  mask_length:
    commands:
      - command: "show ip"
        parser: "textfsm"
        jpath: "raw"
        post_processor: "{% set filtered = obj | map(attribute='ip_address') | map('trim') | select('equalto', '10.228.0.18') | list %}{% if filtered | length > 0 %}{{ filtered | first.subnet_mask | split('.') | map('int') | list | sum | log2 | int | subtract(32) | abs }}{% else %}{{ 24 }}{% endif %}"

sync_network_data:
  interfaces:
    commands:
      - command: "show interfaces brief"
        parser: "textfsm"
        jpath: "[*].interface"
  ip_addresses:
    commands:
      - command: "show ip"
        parser: "textfsm"
        jpath: "[*].ip_address"
  prefixes:
    commands:
      - command: "show ip route"
        parser: "textfsm"
        jpath: "[*].prefix"
  vlans:
    commands:
      - command: "show vlans"
        parser: "textfsm"
        jpath: "[*].vlan_name"
  vrf:
    commands:
      - command: "show vrf"
        parser: "textfsm"
        jpath: "[*].vlan_name"
